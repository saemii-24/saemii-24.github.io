---
title: "Jest - matcher"
author: saemii
categories:
  - Test
tags:
  - [Jest, ReatTestingLibrary]
date: 2024-01-07
last_modified_at: 2024-01-07
pin: true
---

## ğŸ“Œì‹œì‘í•˜ë©°

ì—°ë§ì— ê°€ë³ê²Œ ì§„í–‰í•œ í”„ë¡œì íŠ¸ì—ì„œ Jestë¥¼ ê°„ë‹¨íˆ ì ìš©í•´ë³´ì•˜ë‹¤.
ì—­ì‹œ ì²˜ìŒ ë„ì…í•˜ëŠ” ê²ƒì´ë‹¤ ë³´ë‹ˆ ì‹œê°„ë„ ë§ì´ ì†Œìš”ë˜ê³  ì‚ê·¸ë• ê±°ë¦¬ê¸°ëŠ” í–ˆì§€ë§Œ ê·¸ë˜ì„œ ê·¸ëŸ°ì§€, PASSê°€ ëœ° ë•Œë§ˆë‹¤ ë„ˆë¬´ ê¸°ë»ì„œ ë‹¤ë“¤ ë´ë‹¬ë¼ê³  í•˜ê³  ì‹¶ì—ˆë‹¤... ğŸ¤£

ì–´ì¨Œë“ , ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ìƒˆë¡­ê²Œ ë°°ìš´ Jestì˜ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ë©´ì„œ ë³µìŠµí•´ë³´ë ¤ê³  í•œë‹¤.

## âœ…ë°°ì—´ ê²€ì¦

- ë°°ì—´ ì•ˆì— íŠ¹ì • ê°’ì´ í¬í•¨ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•  ë•ŒëŠ” `toContain`
- ë°°ì—´ ê¸¸ì´ë¥¼ í™•ì¸í•  ë•ŒëŠ” `toHaveLength`

```javascript
const friends = ["ì‹ ì§±êµ¬", "ê¹€ì² ìˆ˜", "í•œìœ ë¦¬"]
it("friends ë°°ì—´ì„ ê²€ì‚¬í•œë‹¤.", () => {
  expect(friends).toContain("ì‹ ì§±êµ¬")
  expect(friends).toHaveLength(3)
})
```

## âœ…ê°ì²´ ê²€ì¦

- ê°ì²´ì— ì›í•˜ëŠ” ê°ì²´ì˜ ì¼ë¶€ê°€ ìˆëŠ”ì§€ í™•ì¸í•  ë•ŒëŠ” `toMatchObject`
- ê°ì²´ì— í•´ë‹¹ í‚¤ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸í•  ë•ŒëŠ” `toHaveProperty`

```javascript
const jjanggu = { name: "ì‹ ì§±êµ¬", class: "í•´ë°”ë¼ê¸°" }
it("jjanggu ê°ì²´ë¥¼ ê²€ì‚¬í•œë‹¤.", () => {
  expect(jjanggu).toMatchObject({ name: "ì‹ ì§±êµ¬" })
  expect(jjanggu).toMatchObject({ name: "ì‹ ì§±êµ¬", class: "í•´ë°”ë¼ê¸°" })
  expect(jjanggu).toMatchObject({ name: "ì‹ ì§±êµ¬", class: "ì¥ë¯¸" }) //Fail
  expect(jjanggu).toHaveProperty("name")
})
```

ì§±êµ¬ëŠ” í•´ë°”ë¼ê¸° ë°˜ì´ê³  ì¥ë¯¸ ë°˜ì´ ì•„ë‹ˆë¯€ë¡œ, ì•„ë˜ í…ŒìŠ¤íŠ¸ëŠ” ì‹¤íŒ¨í•œë‹¤.

```javascript
expect(jjanggu).toMatchObject({ name: "ì‹ ì§±êµ¬", class: "ì¥ë¯¸" }) //Fail
```

## âœ…mocking

í•¨ìˆ˜ (utils)ë¥¼ ëª¨í‚¹í•˜ëŠ” `fn`, `mock`, `spyOn`ì˜ ì“°ì„ìƒˆë¥¼ ì•Œì•„ë³´ì!

### â¡ï¸fn

- ë…ë¦½ì ì¸ **í•¨ìˆ˜**ë¥¼ ëª¨í‚¹í•œë‹¤.
- APIì˜ ì„±ê³µ, ì‹¤íŒ¨ ì‚¬ë¡€ë¥¼ í…ŒìŠ¤íŠ¸ í•  ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ì›ë³¸ í•¨ìˆ˜ë¥¼ importí•  í•„ìš”ê°€ ì—†ë‹¤.

```javascript
it("sum í•¨ìˆ˜ë¥¼ jest.fnìœ¼ë¡œ ëª¨í‚¹í•´ë³¸ë‹¤.", () => {
  const mockSum = jest.fn((a: number, b: number) => {
    if (a === 1 && b === 2) return 10
    if (a === 3 && b === 4) return 20
    return 0
  })

  expect(mockSum(1, 2)).toBe(10)
  expect(mockSum).toHaveBeenCalledWith(1, 2) // í•¨ìˆ˜ ì¸ìê°€ 1, 2ë¡œ í˜¸ì¶œë¨

  expect(mockSum(3, 4)).toBe(20)
  expect(mockSum(5, 6)).toBe(0)
  expect(mockSum).toHaveBeenCalledTimes(3) // í•¨ìˆ˜ê°€ ì„¸ ë²ˆ í˜¸ì¶œë¨
})
```

### â¡ï¸mock

- íŠ¹ì • ëª¨ë“ˆ ì „ì²´ë¥¼ ëª¨í‚¹í•œë‹¤.
  - 'ëª¨ë“ˆ'ì„ **import** í•´ì„œ ì‚¬ìš©í•œë‹¤.

next.jsì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” `next/navigation`ì„ ëª¨í‚¹í•´, pathnameì„ í™”ë©´ì— í‘œì‹œí•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ì.

```javascript
"use client"
import React from "react"
import { usePathname } from "next/navigation"

const Path = () => {
  const pathname = usePathname()
  return <div>{pathname}</div>
}

export default Path
```

1. `jest.mock`ê¸°ëŠ¥ì„ ì´ìš©í•´ `next/navigation`ì„ ëª¨í‚¹í•œë‹¤.
2. ëª¨í‚¹í—¸ì„ ë•Œì˜ ê²°ê³¼ê°’ì€ `mockReturnValue`ë¥¼ ì´ìš©í•´ ì„¤ì •í•œë‹¤.

```javascript
import { render, screen, act } from "@testing-library/react";
import Path from "./Path";
import { usePathname } from "next/navigation";

//ëª¨ë“ˆì„ ëª¨í‚¹í•œë‹¤.
jest.mock("next/navigation", () => ({
  usePathname: jest.fn(),
}));

it("í˜„ì¬ pathê°€ í™”ë©´ì— í‘œì‹œëœë‹¤.", () => {
  // ì´ˆê¸° ê²½ë¡œë¥¼ ì„¤ì •í•œë‹¤.
  (usePathname as jest.Mock).mockReturnValue("/origin-route");

  const { rerender } = render(<Path />); //ë¦¬ë Œë”ë§ì„ ìˆ˜ë™ìœ¼ë¡œ triggerí•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
  screen.debug();

  // í™”ë©´ì— '/origin-route' ê²½ë¡œê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
  expect(screen.getByText("/origin-route")).toBeInTheDocument();

  // ê²½ë¡œë¥¼ ë³€ê²½í•œë‹¤.
  //ë¦¬ë Œë”ë§ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ actë¡œ ê°ì‹¼ë‹¤.
  act(() => {
    (usePathname as jest.Mock).mockReturnValue("/new-route");
  });

  // ê²½ë¡œê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤.
  // ìˆ˜ë™ìœ¼ë¡œ rerender triggerí•´ì¤€ë‹¤.
  rerender(<Path />);
  screen.debug();

  expect(screen.getByText("/new-route")).toBeInTheDocument();
});
```

## ğŸ—‚ï¸ì°¸ê³  ì‚¬ì´íŠ¸

- í”„ëŸ°íŠ¸ì—”ë“œ ê°œë°œì„ ìœ„í•œ í…ŒìŠ¤íŠ¸ ì…ë¬¸
