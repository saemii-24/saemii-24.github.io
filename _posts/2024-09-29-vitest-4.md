---
title: "FEí…ŒìŠ¤íŠ¸(4) - ì „ì—­ ìƒíƒœ ê´€ë¦¬"
author: saemii
categories:
  - Test
tags:
  - [Vitest, ReatTestingLibrary]
date: 2024-09-29
last_modified_at: 2024-09-29
pin: true
---

## ğŸ“Œì‹œì‘í•˜ë©°

ê¸°ë³¸ì ì¸ í…ŒìŠ¤íŠ¸ ê³¼ì •ê³¼ íë¦„ì— ëŒ€í•´ ì•Œì•„ë´¤ìœ¼ë‹ˆ ì´ë²ˆì—” context APIë‚˜ zustandì™€ ê°™ì€ ì „ì—­ ìƒíƒœ ê´€ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸ í•´ë³´ì.

## âœ…context API

ì‚¬ì‹¤ ì²˜ìŒì—” **ì „ì—­ ìƒíƒœ ê´€ë¦¬** ë¥¼ í…ŒìŠ¤íŠ¸ í•œë‹¤ëŠ” ê±°ì— ì–´ë–»ê²Œ í•˜ëŠ”ê±´ì§€ ê³ ë¯¼ë˜ì—ˆì§€ë§Œ,
**ì „ì—­ ìƒíƒœ ê´€ë¦¬** ì— ì´ˆì ì„ ë§ì¶”ì§€ ë§ê³  **ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” ê²ƒ** ì— ì´ˆì ì„ ë§ì¶°ë³´ë©´ ì‰½ê²Œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆë‹¤.

ì „ì²´ì ì¸ íë¦„ë„ ì•ì„œ ì‚´í´ë³¸ ê²ƒê³¼ ë™ì¼í•˜ë‹¤.
íŠ¹ë³„íˆ ì „ì—­ ìƒíƒœ ê´€ë¦¬ë¥¼ ìœ„í•´ APIë¥¼ ì“°ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ Aì—ì„œ íŠ¸ë¦¬ê±°ë¥¼ ë°œìƒì‹œí‚¤ê³  Bì— ì œëŒ€ë¡œ ë°˜ì˜ì´ ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì´ë‹¤.

### â¡ï¸ì˜ˆì œ

ë¨¼ì € context APIë¥¼ ì‘ì„±í•´ì£¼ì—ˆë‹¤.

```typescript
import React, { createContext, useContext, useState, ReactNode } from "react"

// CountContext íƒ€ì… ì •ì˜
interface CountContextType {
  count: number
  increment: () => void
}

// Context ìƒì„±
const CountContext = createContext<CountContextType | undefined>(undefined)

// Provider ì»´í¬ë„ŒíŠ¸
export const CountProvider: React.FC<{ children: ReactNode }> = ({
  children,
}) => {
  const [count, setCount] = useState(0)

  const increment = () => setCount((prev) => prev + 1)

  return (
    <CountContext.Provider value={{ count, increment }}>
      {children}
    </CountContext.Provider>
  )
}

// Hookì„ ì‚¬ìš©í•˜ì—¬ Context ê°’ ì ‘ê·¼
export const useCount = () => {
  const context = useContext(CountContext)
  if (!context) {
    throw new Error("ì—ëŸ¬ ë°œìƒ!")
  }
  return context
}
```

ì´í›„ ê³¼ì •ì€ A ì»´í¬ë„ŒíŠ¸ì—ì„œ incrementë¥¼ í˜¸ì¶œí•˜ê³  B ì»´í¬ë„ŒíŠ¸ì—ì„œ ìˆ«ìë¥¼ ë Œë”ë§í•œë‹¤.
ê°„ë‹¨í•œ ë¶€ë¶„ì´ë¼ ì½”ë“œëŠ” ìƒëµí•œë‹¤.

```typescript
import { CountProvider } from "@/context/CountContext"
import React from "react"
import { AComponent } from "./AComponent"
import { BComponent } from "./BComponent"

const AllComponent = () => {
  return (
    <CountProvider>
      <AComponent />
      <BComponent />
    </CountProvider>
  )
}

export default AllComponent
```

ì´í›„ ë‹¤ìŒê³¼ ê°™ì´ `AComponentì™€` `BComponent`ë¥¼ `CountProvider`ë¡œ ê°ì‹¸ì£¼ì—ˆë‹¤.
ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ `AllComponent.spec.tsx`ë¥¼ ì‘ì„±í•´ ì£¼ì—ˆë‹¤.

ì „ì²´ íë¦„ì€ ìœ„ì—ì„œ ì„¤ëª…í•œ ê²ƒ ì²˜ëŸ¼, ì‚¬ìš©ì ì¸¡ë©´ì—ì„œ í…ŒìŠ¤íŠ¸ ì‘ì„±í•´ì£¼ë©´ ëœë‹¤.

```typescript
import { render, screen, fireEvent } from "@testing-library/react"
import { describe, it, expect } from "vitest"
import AllComponent from "./AllComponent"

describe("All Componet Context API", () => {
  it("A ì»´í¬ë„ŒíŠ¸ì—ì„œ countë¥¼ ì¦ê°€ì‹œí‚¤ë©´, B ì»´í¬ë„ŒíŠ¸ì—ì„œë„ countê°€ ì—…ë°ì´íŠ¸ ëœë‹¤.", () => {
    render(<AllComponent />)

    //aCountì™€ bCountê°€ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— <p data-testid="a-count"/> ì†ì„±ì„ ì‚¬ìš©í•´ êµ¬ë¶„í•œë‹¤.
    //êµ¬ë¶„í•  ìˆ˜ ì—†ì„ë•Œë§Œ ì‚¬ìš©í•¨ì— ì£¼ì˜
    const aCount = screen.getByTestId("a-count")
    const bCount = screen.getByTestId("b-count")

    //Increment ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.
    fireEvent.click(screen.getByText(/Increment/i))

    // A ì»´í¬ë„ŒíŠ¸ì˜ countê°€ 1ë¡œ ì—…ë°ì´íŠ¸ ë˜ì—ˆëŠ”ì§€ í™•ì¸
    expect(aCount).toHaveTextContent("Count: 1")

    // B ì»´í¬ë„ŒíŠ¸ì˜ countë„ 1ë¡œ ì—…ë°ì´íŠ¸ ë˜ì—ˆëŠ”ì§€ í™•ì¸
    expect(bCount).toHaveTextContent("Count: 1")
  })
})
```
