---
title: "supabaseì™€ prisma(2) - prisma CRUD"
author: saemii
categories:
  - Supabase
tags:
  - [Supabase, Prisma, Next.js]
date: 2024-03-04
last_modified_at: 2024-03-04
pin: true
---

## ğŸ“Œì‹œì‘í•˜ë©°

ì´ì–´ì„œ prismaë¥¼ ì´ìš©í•´ api ì‘ì„±ì‹œ, ìì£¼ ì“°ì´ëŠ” ë¬¸ë²•ì„ ì‚´í´ë³´ì!

> ì´ ê¸€ì€ ì•„ë˜ì™€ ê°™ì´ ì´ì–´ì§‘ë‹ˆë‹¤.
>
> - [supabaseì™€ prisma(1) - ê¸°ë³¸ ê°œë…](https://saemii-24.github.io/posts/supabase-1/)
> - [supabaseì™€ prisma(2) - prisma CRUD](https://saemii-24.github.io/posts/supabase-2/)
> - [supabaseì™€ prisma(3) - prisma ì‹¬í™”](https://saemii-24.github.io/posts/supabase-3/)
> - [supabaseì™€ prisma(4) -storage ì´ìš©í•˜ê¸°](https://saemii-24.github.io/posts/supabase-4/)

## âœ… ê³µí†µë¬¸ë²•

CRUDë¥¼ ì‚¬ìš©í•  ë•Œ ê³µí†µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ë¨¼ì € ì•Œì•„ë³´ì.

1. prismaë¥¼ ì‚¬ìš©í•´ DBì‘ì—…ì‹œ, PrismaClient ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.
2. ì•„ë˜ ì˜ˆì œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, `await prisma` ë‹¤ìŒì˜ `user`ëŠ” ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ `User` í…Œì´ë¸”ì„ **ì†Œë¬¸ì**ë¡œ ì‘ì„±í•œ ê²ƒì´ë‹¤. ë§Œì•½ ë°ì´í„°ë² ì´ìŠ¤ê°€ `Post` ë¼ë©´ `await prisma.post`ë¡œ ì‘ì„±í•´ì£¼ë©´ ëœë‹¤.

```typescript
import { PrismaClient, Prisma } from "@prisma/client" ğŸ‘ˆ

const prisma = new PrismaClient() ğŸ‘ˆ

const user = await prisma.userğŸ‘ˆ.create({
  data: {
    email: "elsa@prisma.io",
    name: "Elsa Prisma",
  },
})
```

## âœ… Create

ë ˆì½”ë“œë¥¼ ìƒì„±í•´ë³´ì!

### â¡ï¸ Single record

ë¨¼ì € single recordë¥¼ ë§Œë“¤ì–´ ë³´ì. ê°„ë‹¨íˆ `create`ë¥¼ ì´ìš©í•˜ê³  ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ë©´ ëœë‹¤.

```typescript
const user = await prisma.user.create({
  data: {
    email: "elsa@prisma.io",
    name: "Elsa Prisma",
  },
})
```

### â¡ï¸ multiple record

`createMany` ë¥¼ ì‚¬ìš©í•´ ì—¬ëŸ¬ recordë¥¼ í•œ ë²ˆì— ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì´ë•Œ unique Key ê°’ì´ ì¤‘ë³µëœ ê²½ìš°,`skipDuplicates: true` ì†ì„±ì„ ì‚¬ìš©í•´ í•´ë‹¹ dataë¥¼ ê±´ë„ˆë›¸ ìˆ˜ ìˆë‹¤.

ì˜ˆì œì—ì„œëŠ” emailì´ unique Keyë¡œ í˜„ì¬ nameì´ Bobì¸ recordì™€ Boboê°€ ê²¹ì¹˜ê²Œ ë˜ê³ , `skipDuplicates: true`ë¡œ ì¸í•´ í•´ë‹¹ ë‚´ìš©ì„ ê±´ë„ˆë›°ê²Œ ëœë‹¤.

```typescript
const createMany = await prisma.user.createMany({
  data: [
    { name: "Bob", email: "bob@prisma.io" },
    { name: "Bobo", email: "bob@prisma.io" }, // email(unique key)ì¤‘ë³µ
    { name: "Yewande", email: "yewande@prisma.io" },
    { name: "Angelique", email: "angelique@prisma.io" },
  ],
  skipDuplicates: true, // 'Bobo' ë°ì´í„°ë¥¼ ê±´ë„ˆë›´ë‹¤.
})
```

## âœ… Read

ë‚´ìš©ì„ ì½ì–´ë³´ì!

### â¡ï¸ ID ë˜ëŠ” ê³ ìœ ì‹ë³„ìë¥¼ ì´ìš©í•´ ë¶ˆëŸ¬ì˜¤ê¸°

`findUnique` ë¥¼ ì´ìš©í•´ single record ê°’ì„ ì½ì–´ì˜¬ ìˆ˜ ìˆë‹¤. ì´ë•Œ ì¡°ê±´ì€ `where` ì•ˆì— ì‘ì„±í•´ì£¼ë©´ ëœë‹¤.

```typescript
// ID ì´ìš©í•˜ê¸°
const user = await prisma.user.findUnique({
  where: {
    id: 99,
  },
})

// ê³ ìœ ì‹ë³„ì ì´ìš©í•˜ê¸°
const user = await prisma.user.findUnique({
  where: {
    email: "elsa@prisma.io",
  },
})
```

### â¡ï¸ ì „ì²´ ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸°

ì´ë²ˆì—” `findMany`ë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤.

```typescript
const users = await prisma.user.findMany()
```

## âœ…Update

### â¡ï¸ single record ì—…ë°ì´íŠ¸ í•˜ê¸°

ê°„ë‹¨íˆ `update`ë¥¼ ì‚¬ìš©í•´ì£¼ë©´ ëœë‹¤. ì˜ˆì œë¥¼ ì‚´í´ë³´ë©´

1. where ì¡°ê±´ë¬¸ìœ¼ë¡œ, emailì´(ê³ ìœ ì‹ë³„ì) `viola@prisma.io` ì¸ ê°’ì„ ì°¾ëŠ”ë‹¤.
2. nameì„ `Viola the Magnificent`ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤.

```typescript
const updateUser = await prisma.user.update({
  where: {
    email: "viola@prisma.io",
  },
  data: {
    name: "Viola the Magnificent",
  },
})
```

### â¡ï¸ multiple records ì—…ë°ì´íŠ¸ í•˜ê¸°

ì´ë²ˆì—” `updateMany` ë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤. ì´ ì˜ˆì œë¥¼ ì‚´í´ë³´ë©´

1. where ì¡°ê±´ë¬¸ìœ¼ë¡œ emailì— `prisma.io`ê°€ í¬í•¨ëœ recordsë¥¼ ì°¾ëŠ”ë‹¤.
2. recordsì˜ roleë“¤ì„ ADMINìœ¼ë¡œ ë³€ê²½í•œë‹¤.

```typescript
const updateUsers = await prisma.user.updateMany({
  where: {
    email: {
      contains: "prisma.io",
    },
  },
  data: {
    role: "ADMIN",
  },
})
```

### â¡ï¸ recordê°€ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸, ì—†ë‹¤ë©´ ìƒì„±

ë§Œì•½ íŠ¹ì • recordë¥¼ ì°¾ì•„ì„œ ìˆë‹¤ë©´ ê°’ì„ ì—…ë°ì´íŠ¸ í•˜ê³  ì—†ë‹¤ë©´ ìƒì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆë‹¤. ì´ë•ŒëŠ” `upsert`ë¥¼ ì‚¬ìš©í•œë‹¤.
í•´ë‹¹ ì˜ˆì œì—ì„œëŠ”

1. where ì¡°ê±´ë¬¸ìœ¼ë¡œ email ê°’ì´`viola@prisma.io`ì¸ recordë¥¼ ì°¾ëŠ”ë‹¤.
2. ë§Œì•½ ìˆëŠ” ê²½ìš° nameì„ ì—…ë°ì´íŠ¸ í•œë‹¤.
3. ë§Œì•½ í•´ë‹¹ recordê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ê²½ìš° emailê³¼ nameì„ ë„£ì–´ ìƒì„±í•´ì¤€ë‹¤.

```typescript
const upsertUser = await prisma.user.upsert({
  where: {
    email: "viola@prisma.io",
  },
  update: {
    name: "Viola the Magnificent",
  },
  create: {
    email: "viola@prisma.io",
    name: "Viola the Magnificent",
  },
})
```

## âœ…Delete

ë§ˆì§€ë§‰ìœ¼ë¡œ íŠ¹ì • recordë¥¼ ì‚­ì œí•´ë³´ì.

### â¡ï¸ single record ì‚­ì œí•˜ê¸°

í•œ ê°œë§Œ ì‚­ì œí•˜ê³  ì‹¶ì„ ë•ŒëŠ” `delete`ì™€ í•´ë‹¹ recordë¥¼ ì‹ë³„í•  ì¡°ê±´ì„ ì‘ì„±í•´ì£¼ë©´ ëœë‹¤.

```typescript
const deleteUser = await prisma.user.delete({
  where: {
    email: "bert@prisma.io",
  },
})
```

### â¡ï¸ multiple records ì‚­ì œí•˜ê¸°

ì—¬ëŸ¬ê°œë¥¼ ì‚­ì œí•˜ê³  ì‹¶ì„ ë•ŒëŠ” `deleteMany`ì™€ í•´ë‹¹ recordsë¥¼ ì‹ë³„í•  ì¡°ê±´ì„ ì‘ì„±í•´ì£¼ë©´ ëœë‹¤.

```typescript
const deleteUsers = await prisma.user.deleteMany({
  where: {
    email: {
      contains: "prisma.io",
    },
  },
})
```

### ì „ë¶€ ì‚­ì œí•˜ê¸°

ëª¨ë“  recordsë¥¼ ì‚­ì œí•˜ê³  ì‹¶ì€ ê²½ìš°, <u>ì¡°ê±´ì„ ì‘ì„±í•˜ì§€ ì•Šê³ </u> `deleteMany`ë¥¼ ì‚¬ìš©í•œë‹¤.

```typescript
const deleteUsers = await prisma.user.deleteMany({})
```

## ğŸ“©ë§ˆë¬´ë¦¬

ê¸°ë³¸ CRUDë¥¼ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ ì¢€ ë” ìì„¸í•œ ë‚´ìš©ì€ ë¶„ë¦¬í•´ì„œ ì‘ì„±í•  ì˜ˆì •ì´ë‹¤.ğŸ˜

## ğŸ—‚ï¸ì°¸ê³  ì‚¬ì´íŠ¸

- <https://www.prisma.io/docs/orm/prisma-client/queries/crud>
