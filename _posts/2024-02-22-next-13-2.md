---
title: "Next.js 13ì˜ íŠ¹ì§•ê³¼ ë³€í™”(2) - í´ë”êµ¬ì¡°"
author: saemii
categories:
  - Next.js
tags:
  - [Next.js, Web]
date: 2024-02-23
last_modified_at: 2024-02-23
pin: true
---

## ğŸ“Œì‹œì‘í•˜ë©°

> ì´ ê¸€ì€ ì•„ë˜ì™€ ê°™ì´ ì´ì–´ì§‘ë‹ˆë‹¤.
>
> - [Next.js 13ì˜ íŠ¹ì§•ê³¼ ë³€í™”(1)](https://saemii-24.github.io/posts/next-13-1/)
> - [Next.js 13ì˜ íŠ¹ì§•ê³¼ ë³€í™”(2)](https://saemii-24.github.io/posts/next-13-2/)
> - [Next.js 13ì˜ íŠ¹ì§•ê³¼ ë³€í™”(3)](https://saemii-24.github.io/posts/next-13-3/)

ì´ ë²ˆì—” Next13ì˜ ê½ƒğŸŒº app í´ë”ë¥¼ ì‚´í´ë³´ê³ , api ì‘ì„±ë²•ì— ëŒ€í•´ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.

## âœ…app router

```
app/
â”‚
â”œâ”€â”€â”€page.js ğŸ‘ˆ
â”‚
â””â”€â”€â”€dashboard/
    â”‚
    â”œâ”€â”€â”€page.js ğŸ‘ˆ
    â”‚
    â””â”€â”€â”€about.js
```

ê¸°ë³¸ì ìœ¼ë¡œ app router ë°©ì‹ì—ì„œëŠ” í´ë”ì´ë¦„ì´ ë£¨ë“œê°€ ë˜ë©°, í•´ë‹¹ ë£¨íŠ¸ì˜ ê¸°ë³¸ í˜ì´ì§€ë¥¼ ì •ì˜í•  ë• `page.js` íŒŒì¼ì„ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë©´ë©´ ëœë‹¤.

- `/` ê²½ë¡œëŠ” `app/page.js`
- `/dashboard`ê²½ë¡œëŠ” `app/dashboard/page.js`
- `/dashboard/about` ê²½ë¡œëŠ” `app/dashboard/about.js`

## âœ…layout.js

ê¸°ì¡´ì˜ `pages/_app.js`ì™€ `pages/_document.js`ëŠ” ë‹¨ì¼ íŒŒì¼ì¸ `app/layout.js`ë¡œ ëŒ€ì²´ë˜ì—ˆë‹¤!
layoutì€ ì—¬ëŸ¬ ê²½ë¡œ ê°„ì— ê³µìœ ë˜ëŠ” UIë¥¼ ì •ì˜í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

```
app/
â”‚
â””â”€â”€â”€dashboard/
    â”‚
    â”œâ”€â”€â”€layout.js ğŸ‘ˆ
    â”œâ”€â”€â”€about.js
    â””â”€â”€â”€page.js
```

ë§Œì•½ ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  ìƒê°í•´ë³´ì. dashboard í´ë”ì— `layout.js` ë¥¼ ì´ìš©í•˜ë©´ `/dashboard`ì™€ `/dashboard/about` ì˜ í™”ë©´ì—ì„œ ê³µí†µ ëœ UIë¥¼ í‘œì‹œí•  ìˆ˜ ìˆë‹¤!

```typescript
//app/dashboard/layout.tsx
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <section>
      {/* ê³µìœ  UIë¥¼ ì‘ì„±í•œë‹¤ */}
      <nav></nav>
      {children}
    </section>
  )
}
```

### â¡ï¸Root layout.js(í•„ìˆ˜)

ì•„ë˜ì™€ ê°™ì´ appí´ë” ìµœìƒìœ„ì˜ `layout.js`ì€ í•„ìˆ˜ ê°’ìœ¼ë¡œ, ëª¨ë“  ê²½ë¡œì— ì ìš©ëœë‹¤. ì´ ë ˆì´ì•„ì›ƒì—ëŠ” HTML ê³¼ ë³¸ë¬¸ íƒœê·¸ë¥¼ í¬í•¨í•´ì•¼ í•œë‹¤. ë˜í•œ `layout.js`ì—ì„œ ì •ì˜í•œ UIëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì¤‘ì²©ë˜ë¯€ë¡œ, `/dashboard` ê²½ë¡œì—ì„œëŠ” ë£¨íŠ¸ì—ì„œ ì •ì˜í•œ layoutê³¼ dashboardì—ì„œ ì •ì˜í•œ layout ëª¨ë‘ í‘œì‹œëœë‹¤.

```
app/
â”‚
â”œâ”€â”€â”€layout.js //í•„ìˆ˜ê°’
â”œâ”€â”€â”€page.js
â”‚
â””â”€â”€â”€dashboard/
    â”‚
    â”œâ”€â”€â”€layout.js ğŸ‘ˆ
    â””â”€â”€â”€page.js
```

```typescript
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="ko">
      <body>
        <main>{children}</main>
      </body>
    </html>
  )
}
```

## âœ…not-found.js

not-found.jsëŠ” ì´ë¦„ ì²˜ëŸ¼ ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ í‘œì‹œí•  UIë¥¼ ë Œë”ë§ í•œë‹¤.

```
app/
â”‚
â”œâ”€â”€â”€layout.js
â”œâ”€â”€â”€page.js
â””â”€â”€â”€not-found.js ğŸ‘ˆ
```

```typescript
import Link from "next/link"

export default function NotFound() {
  return (
    <div>
      <h2>404 Not Found</h2>
      <p>ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
      <Link href="/">ëŒì•„ê°€ê¸°</Link>
    </div>
  )
}
```

## âœ…error.js

error íŒŒì¼ì€ error ë°œìƒì‹œì— í‘œì‹œ ë  UIë¥¼ ì •ì˜í•œë‹¤. error.js íŒŒì¼ ê·œì¹™ì„ ì‚¬ìš©í•´ ì¤‘ì²©ëœ ê²½ë¡œì—ì„œ ì˜ˆê¸°ì¹˜ ì•Šì€ ëŸ°íƒ€ì„ ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê³ , ì „ì²´ í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ì§€ ì•Šê³  ì˜¤ë¥˜ì—ì„œ ë³µêµ¬ë¥¼ ì‹œë„í•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

```
app/
â”‚
â”œâ”€â”€â”€layout.js //í•„ìˆ˜ê°’
â”œâ”€â”€â”€page.js
â”‚
â””â”€â”€â”€dashboard/
    â”‚
    â”œâ”€â”€â”€error.js ğŸ‘ˆ
    â”œâ”€â”€â”€layout.js
    â””â”€â”€â”€page.js
```

dashboard í´ë”ì—ì„œ `error.js` íŒŒì¼ì„ ìƒì„±í•œë‹¤ê³  ê°€ì •í•˜ê³ , ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ë³´ì. `error.js`ëŠ” ì¤‘ì²©ëœ ìì‹ ì„¸ê·¸ë¨¼íŠ¸ ë˜ëŠ” `page.js` ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ëŠ” React ì˜¤ë¥˜ ë°”ìš´ë”ë¦¬ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•œë‹¤.

ì¦‰, dashboardì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ, dashboard ì»´í¬ë„ŒíŠ¸ ì˜ì—­ì„ `error.js` íŒŒì¼ì—ì„œ ë‚´ë³´ë‚¸ React ì»´í¬ë„ŒíŠ¸ê°€ fallback(ëŒ€ì²´) ì»´í¬ë„ŒíŠ¸ë¡œ ì‚¬ìš©ëœë‹¤ëŠ” ê²ƒ!

```typescript
//app/dashboard/error.tsx
"use client" // error ì»´í¬ë„ŒíŠ¸ëŠ” ë°˜ë“œì‹œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë‹¤.

import { useEffect } from "react"

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  useEffect(() => {
    // ì—ëŸ¬ ë¡œê·¸ë¥¼ í™•ì¸í•œë‹¤
    console.error(error)
  }, [error])

  return (
    <div>
      <h2>ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!</h2>
      <button
        onClick={
          // ì¬ë Œë”ë§ì„ ì‹œë„í•œë‹¤.
          () => reset()
        }
      >
        ì¬ì‹œë„ í•˜ê¸°
      </button>
    </div>
  )
}
```

- `error`: `error.js` í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ ì „ë‹¬ëœ ì˜¤ë¥˜ ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤
- `reset`: error boundaryë¥¼ resetí•˜ëŠ” í•¨ìˆ˜. ì´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ error boundaryì˜ ë‚´ìš©ì„ ë‹¤ì‹œ ë Œë”ë§í•˜ë©°, ì„±ê³µí•˜ë©´ í´ë°± ì˜¤ë¥˜ ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ì‹œ ë Œë”ë§í•œ ê²°ê³¼ë¡œ ëŒ€ì²´ëœë‹¤.

### â¡ï¸global-error.js

ë§Œì•½ `app/page.js` ì¦‰ ìµœìƒìœ„ í˜ì´ì§€ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ì–´ë–»ê²Œ í• ê¹Œ? ì´ë•Œ `app/error.js`ëŠ” `app/layout.js` ë˜ëŠ” `app/template.js` ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¥¼ ì ì ˆíˆ ì²˜ë¦¬í•˜ì§€ ëª»í•œë‹¤.

ì¦‰ ì´ê²½ìš°ì—ëŠ” `app/global-error.js` ë¥¼ ì‚¬ìš©í•´ ì²˜ë¦¬í•œë‹¤.
`global-error.js` ëŠ” ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°ì‹¸ë©°, í™œì„±í™”ë˜ë©´ í•´ë‹¹ fallback(ëŒ€ì²´) ì»´í¬ë„ŒíŠ¸ê°€ ë£¨íŠ¸ ë ˆì´ì•„ì›ƒì„ ëŒ€ì²´í•œë‹¤.

ë”°ë¼ì„œ, `global-error.js`ëŠ” ìì²´ `<html>` ë° `<body>` íƒœê·¸ë¥¼ ì •ì˜í•´ì•¼ í•œë‹¤!

```typescript
"use client"

export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  return (
    <html>
      <body>
        <h2>ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!</h2>
        <button onClick={() => reset()}>ì¬ì‹œë„ í•˜ê¸°n</button>
      </body>
    </html>
  )
}
```

## âœ…middleware.js

ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ìš”ì²­ì´ ì™„ë£Œë˜ê¸° ì „ì— ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì˜ˆ ë“¤ì–´ ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìì¸ì§€ í™•ì¸í•˜ê³ , redirect í•˜ëŠ” ë“±ì´ í¬í•¨ëœë‹¤.
`middleware.js`ëŠ” í”„ë¡œì íŠ¸ì˜ rootì— `middleware.ts(ë˜ëŠ” .js)` íŒŒì¼ì„ ì‚¬ìš©í•´ ì •ì˜í•œë‹¤. app í´ë”ì™€ ê°™ì€ levelì—ì„œ ì •ì˜í•˜ë©´ ëœë‹¤.

```typescript
import { NextResponse } from "next/server"
import type { NextRequest } from "next/server"

// ë‚´ë¶€ì— `await`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° `async`ë¡œ í‘œì‹œí•  ìˆ˜ ìˆë‹¤.
export function middleware(request: NextRequest) {
  return NextResponse.redirect(new URL("/home", request.url))
}

export const config = {
  matcher: "/about/:path*",
}
```

### â¡ï¸matcher

â¡ï¸matcherë¥¼ ì‚¬ìš©í•´ íŠ¹ì • ê²½ë¡œì—ì„œ ì‹¤í–‰ë˜ë„ë¡ ë¯¸ë“¤ì›¨ì–´ë¥¼ í•„í„°ë§í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ ì•„ë˜ì™€ ê°™ì´ ì—¬ëŸ¬ pathë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

```typescript
export const config = {
  matcher: ["/about/:path*", "/dashboard/:path*"],
}
```

## âœ…Metadata

`<head>` ì—ì„œ ì •ì˜ ë˜ì–´ì•¼ í•  `title`ê³¼ ê°™ì€ ìš”ì†ŒëŠ” ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•  ìˆ˜ ìˆë‹¤. [MetaData](https://nextjs.org/docs/app/building-your-application/optimizing/metadata)ì— ê´€í•œ ë” ìì„¸í•œ ì„¤ëª…ì€ ë‹¤ë¥¸ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë£¨ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

```typescript
//app/page.tsx
import { Metadata } from "next"

export const metadata: Metadata = {
  title: "Next.js",
  description: "...",
}

export default function Page() {
  return "..."
}
```

## ğŸ“©ë§ˆë¬´ë¦¬

app routerì˜ í´ë” êµ¬ì¡°ë¥¼ ì´ë ‡ê²Œ í›‘ì–´ë³´ì•˜ë‹¤. ë‹¤ìŒì—ëŠ” api routes ì‘ì„±ë²•ì— ëŒ€í•´ ì‚´í´ë³´ì!

## ğŸ—‚ï¸ì°¸ê³  ì‚¬ì´íŠ¸

- <https://nextjs.org/docs/app/api-reference/file-conventions>
- <https://nextjs.org/docs/app/building-your-application/routing/error-handling>
